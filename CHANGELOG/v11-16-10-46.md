# v11-16-10:46 - 예상 피해량 창 레이아웃 및 로그 색상 수정

**날짜**: 2025-11-16 10:46 (KST)
**커밋**: (커밋 예정)

## 변경 사항

### 1. 레이아웃 순서 변경

**파일**: `src/components/battle/LegacyBattleApp.jsx` (408-451줄)

#### 변경 전
```
플레이어 HP (상단, 굵게)
─────────────────
Summary (예상 가한 피해, 피격 피해)
─────────────────
Logs
─────────────────
몬스터 HP (하단, 붉은색)
```

#### 변경 후
```
Summary (예상 가한 피해, 피격 피해)
─────────────────
플레이어 HP (굵게, 흰색)
몬스터 HP (붉은색)
─────────────────
Logs
```

### 2. HP 정보 통합

**파일**: `src/components/battle/LegacyBattleApp.jsx` (422-431줄)

```jsx
{/* HP 정보 - Summary 하단 */}
<div style={{marginTop: '16px', paddingTop: '16px', borderTop: '1px solid rgba(148, 163, 184, 0.15)'}}>
  <div style={{fontSize: '16px', fontWeight: 'bold', color: '#e2e8f0', marginBottom: '8px'}}>
    플레이어 HP {player.hp} → {res.finalPHp}
  </div>
  <div style={{fontSize: '14px', color: '#fca5a5'}}>
    몬스터 HP {enemy.hp} → {res.finalEHp}
  </div>
  {willOverdrive && <span className="expect-tag" style={{marginTop: '8px', display: 'inline-block'}}>기도 미리보기</span>}
</div>
```

- 플레이어 HP와 몬스터 HP를 한 영역에 통합
- Summary("플레이어 피격 피해") 하단에 배치
- 플레이어 HP: 16px, 굵게, 흰색, marginBottom: 8px
- 몬스터 HP: 14px, 붉은색

### 3. 로그 색상 조건 변경

**파일**: `src/components/battle/LegacyBattleApp.jsx` (435-436줄)

#### 변경 전
```jsx
const isMonsterAttack = line.includes('몬스터') && (line.includes('플레이어') || line.includes('데미지') || line.includes('반격') || line.includes('관통'));
```

- 몬스터가 플레이어에게 가하는 공격만 붉은색
- 복잡한 조건 검사

#### 변경 후
```jsx
const isMonsterAction = line.includes('몬스터 ->') || line.includes('몬스터→');
```

- 몬스터의 모든 행동을 붉은색으로 표시
- 간단한 조건: "몬스터 ->" 또는 "몬스터→" 포함 여부만 검사
- 플레이어의 모든 행동은 흰색으로 표시

## 기술 세부사항

### 레이아웃 구조

```
┌──────────────────────────┐
│ 🗡️ 플레이어 예상 가한 피해 │
│    값: XX                │
├──────────────────────────┤
│ 💥 플레이어 피격 피해     │
│    값: XX                │
├──────────────────────────┤
│ 플레이어 HP XX → XX (굵게)│
│ 몬스터 HP XX → XX (붉은색)│
├──────────────────────────┤
│ Logs                     │
│ 1. 플레이어 -> ... (흰색) │
│ 2. 몬스터 -> ... (붉은색) │
│ 3. 플레이어 -> ... (흰색) │
└──────────────────────────┘
```

### 색상 로직

| 로그 내용 | 조건 | 색상 |
|----------|------|------|
| 플레이어 -> 몬스터 • 데미지 XX | `line.includes('몬스터 ->')` = false | #cbd5e1 (흰색) |
| 플레이어 -> 몬스터 • 방어 +XX | `line.includes('몬스터 ->')` = false | #cbd5e1 (흰색) |
| 몬스터 -> 플레이어 • 데미지 XX | `line.includes('몬스터 ->')` = true | #fca5a5 (붉은색) |
| 몬스터 -> 플레이어 • 반격 XX | `line.includes('몬스터 ->')` = true | #fca5a5 (붉은색) |

### 정보 계층

1. **Summary (최상단)**: 전투 요약 정보
   - 플레이어 예상 가한 피해
   - 플레이어 피격 피해

2. **HP 정보 (중간)**: 전투 후 상태 예측
   - 플레이어 HP (강조)
   - 몬스터 HP (보조 정보)

3. **Logs (하단)**: 상세 전투 로그
   - 플레이어 행동: 흰색 (기본)
   - 몬스터 행동: 붉은색 (위험 강조)

## UI 개선 효과

### 장점

1. **정보 흐름 개선**
   - Summary → HP → Logs 순서로 요약에서 상세로 이동
   - 사용자가 원하는 수준의 정보를 단계적으로 확인

2. **HP 정보 통합**
   - 플레이어 HP와 몬스터 HP가 함께 표시되어 비교 용이
   - Summary 바로 아래 배치로 전투 결과 즉시 파악

3. **색상 구분 단순화**
   - 플레이어 행동: 흰색 (안전)
   - 몬스터 행동: 붉은색 (위험)
   - 행동 주체만으로 색상 결정, 직관적

4. **로그 가독성 향상**
   - 색상으로 누가 행동했는지 즉시 파악
   - 몬스터의 위협적인 행동을 시각적으로 강조

### 사용자 경험

- **빠른 판단**: Summary로 전투 결과 요약 확인
- **상세 확인**: 필요시 아래로 스크롤하여 로그 확인
- **위험 인식**: 붉은색 로그로 몬스터의 위협 즉시 파악

## 이전 버전과의 차이

**이전 버전 (v11-16-09:59)**:
- 플레이어 HP 상단, 몬스터 HP 하단 (분리)
- 복잡한 색상 조건 (몬스터가 플레이어에게 가하는 공격만)
- 순서: 플레이어 HP → Summary → Logs → 몬스터 HP

**현재 버전**:
- 플레이어 HP와 몬스터 HP 통합 (Summary 하단)
- 간단한 색상 조건 (몬스터의 모든 행동)
- 순서: Summary → HP (플레이어, 몬스터) → Logs

## 다음 AI를 위한 참고사항

1. **색상 조건 확장**:
   - 현재: `line.includes('몬스터 ->')` 또는 `line.includes('몬스터→')`
   - 로그 형식이 변경되면 조건도 수정 필요
   - 정규표현식으로 변경 가능: `/몬스터\s*-?→/`

2. **HP 정보 위치**:
   - Summary 하단에 배치하여 전투 결과 요약 강화
   - 필요시 다시 상단으로 이동 가능

3. **레이아웃 조정**:
   - marginTop: 16px, paddingTop: 16px으로 적절한 간격 유지
   - borderTop으로 섹션 구분

4. **색상 일관성**:
   - 플레이어: #cbd5e1 (회색, 안전)
   - 몬스터: #fca5a5 (붉은색, 위험)
   - 전체 UI에서 일관된 색상 사용

5. **반응형 고려**:
   - fontSize가 고정값 (16px, 14px)
   - 작은 화면에서는 조정 필요할 수 있음

## 변경 파일 목록

- `src/components/battle/LegacyBattleApp.jsx`
  - ExpectedDamagePreview 레이아웃 변경 (408-451줄)
  - HP 정보 통합 및 위치 변경 (422-431줄)
  - 로그 색상 조건 단순화 (435-436줄)
- `src/components/map/MapDemo.jsx`
  - 버전 태그 업데이트
- `CHANGELOG/v11-16-10-46.md`
  - 새 버전 문서 생성
