# v11-16-09:59 - 예상 피해량 창 색상 및 레이아웃 개선

**날짜**: 2025-11-16 09:59 (KST)
**커밋**: (커밋 예정)

## 변경 사항

### 1. HP 정보 레이아웃 재구성

**파일**: `src/components/battle/LegacyBattleApp.jsx` (408-455줄)

#### 변경 전
```jsx
<div className="expect-hp-vertical">
  {hpLines.map((line)=>(
    <div key={line}>{line}</div>
  ))}
  {willOverdrive && <span className="expect-tag">기도 미리보기</span>}
</div>
```

- 플레이어 HP와 몬스터 HP가 하단에 함께 표시
- 일반 텍스트로 표시
- 순서: Summary → Logs → HP (플레이어, 몬스터)

#### 변경 후
```jsx
{/* 플레이어 HP - 상단, 굵게 */}
<div style={{marginBottom: '16px', paddingBottom: '16px', borderBottom: '1px solid rgba(148, 163, 184, 0.15)'}}>
  <div style={{fontSize: '16px', fontWeight: 'bold', color: '#e2e8f0'}}>
    플레이어 HP {player.hp} → {res.finalPHp}
  </div>
  {willOverdrive && <span className="expect-tag" style={{marginTop: '8px', display: 'inline-block'}}>기도 미리보기</span>}
</div>

{/* Summary & Logs */}

{/* 몬스터 HP - 하단, 옅은 붉은색 */}
<div style={{marginTop: '12px', paddingTop: '12px', borderTop: '1px solid rgba(148, 163, 184, 0.15)'}}>
  <div style={{fontSize: '14px', color: '#fca5a5'}}>
    몬스터 HP {enemy.hp} → {res.finalEHp}
  </div>
</div>
```

- 플레이어 HP: 상단, 16px, 굵은 글씨, 흰색
- 몬스터 HP: 하단, 14px, 옅은 붉은색 (#fca5a5)
- 순서: 플레이어 HP → Summary → Logs → 몬스터 HP

### 2. 로그 색상 조건부 적용

**파일**: `src/components/battle/LegacyBattleApp.jsx` (430-446줄)

#### 변경 전
```jsx
{res.lines.map((line,idx)=>(
  <div key={idx} style={{fontSize: '13px', color: '#cbd5e1', marginBottom: '6px'}}>
    <span style={{color: '#94a3b8', marginRight: '4px'}}>{idx + 1}.</span>
    {line}
  </div>
))}
```

- 모든 로그가 동일한 색상 (#cbd5e1)

#### 변경 후
```jsx
{res.lines.map((line,idx)=>{
  const isMonsterAttack = line.includes('몬스터') && (line.includes('플레이어') || line.includes('데미지') || line.includes('반격') || line.includes('관통'));
  return (
    <div key={idx} style={{
      fontSize: '13px',
      color: isMonsterAttack ? '#fca5a5' : '#cbd5e1',
      marginBottom: '6px'
    }}>
      <span style={{color: '#94a3b8', marginRight: '4px'}}>{idx + 1}.</span>
      {line}
    </div>
  );
})}
```

- 몬스터가 플레이어에게 가하는 로그: 옅은 붉은색 (#fca5a5)
- 나머지 로그: 기본 색상 (#cbd5e1)
- 조건: `line.includes('몬스터')` AND (`플레이어` OR `데미지` OR `반격` OR `관통`)

## 기술 세부사항

### 색상 팔레트

| 요소 | 색상 코드 | 설명 |
|------|-----------|------|
| 플레이어 HP | #e2e8f0 | 밝은 흰색 (강조) |
| 몬스터 HP | #fca5a5 | 옅은 붉은색 (rose-300) |
| 몬스터 공격 로그 | #fca5a5 | 옅은 붉은색 (위험 표시) |
| 일반 로그 | #cbd5e1 | 회색 (기본) |
| 로그 번호 | #94a3b8 | 어두운 회색 |

### 레이아웃 변화

**이전**:
```
┌─────────────────────┐
│ Summary             │
│ - 예상 가한 피해    │
│ - 피격 피해         │
├─────────────────────┤
│ Logs                │
│ 1. 로그...          │
│ 2. 로그...          │
├─────────────────────┤
│ HP 정보             │
│ - 플레이어 HP       │
│ - 몬스터 HP         │
└─────────────────────┘
```

**변경 후**:
```
┌─────────────────────┐
│ 플레이어 HP (굵게)  │ ← 상단으로 이동, 강조
├─────────────────────┤
│ Summary             │
│ - 예상 가한 피해    │
│ - 피격 피해         │
├─────────────────────┤
│ Logs                │
│ 1. 로그... (기본)   │
│ 2. 로그... (붉은색) │ ← 몬스터 공격
│ 3. 로그... (기본)   │
├─────────────────────┤
│ 몬스터 HP (붉은색)  │ ← 하단으로 이동
└─────────────────────┘
```

### 조건부 색상 로직

```javascript
const isMonsterAttack = line.includes('몬스터') && (
  line.includes('플레이어') ||
  line.includes('데미지') ||
  line.includes('반격') ||
  line.includes('관통')
);
```

**매칭 예시**:
- ✅ "몬스터 -> 플레이어 • 데미지 10 (체력 60 -> 50)"
- ✅ "몬스터 -> 플레이어 • 반격 5 (체력 55 -> 50)"
- ✅ "몬스터 -> 플레이어 • 차단 10, 관통 5 (체력 60 -> 55)"
- ❌ "플레이어 -> 몬스터 • 데미지 20 (체력 100 -> 80)"

### 스타일 세부사항

#### 플레이어 HP
```jsx
<div style={{
  marginBottom: '16px',
  paddingBottom: '16px',
  borderBottom: '1px solid rgba(148, 163, 184, 0.15)'
}}>
  <div style={{
    fontSize: '16px',
    fontWeight: 'bold',
    color: '#e2e8f0'
  }}>
    플레이어 HP {player.hp} → {res.finalPHp}
  </div>
</div>
```

- 하단 테두리로 구분
- 16px, 굵은 글씨
- 밝은 흰색

#### 몬스터 HP
```jsx
<div style={{
  marginTop: '12px',
  paddingTop: '12px',
  borderTop: '1px solid rgba(148, 163, 184, 0.15)'
}}>
  <div style={{
    fontSize: '14px',
    color: '#fca5a5'
  }}>
    몬스터 HP {enemy.hp} → {res.finalEHp}
  </div>
</div>
```

- 상단 테두리로 구분
- 14px, 일반 글씨
- 옅은 붉은색

## UI 개선 효과

### 장점

1. **정보 계층 구조 명확화**
   - 플레이어 HP가 상단에 굵게 표시되어 즉시 확인 가능
   - 몬스터 HP는 하단에 덜 강조되어 보조 정보로 표시

2. **위험 정보 시각화**
   - 몬스터의 공격이 붉은색으로 표시되어 위험 정보 강조
   - 플레이어 공격은 일반 색상으로 안정감 유지

3. **가독성 향상**
   - 플레이어 HP가 크고 굵어서 쉽게 파악
   - 색상으로 공격 주체를 빠르게 구분

4. **레이아웃 흐름 개선**
   - 플레이어 HP (나) → Summary (전투 요약) → Logs (상세) → 몬스터 HP (적)
   - 나의 상태부터 적의 상태까지 자연스러운 흐름

### 사용자 경험

- **전투 예측**: 플레이어 HP를 먼저 보고 생존 여부 판단
- **위험 인식**: 붉은색 로그로 몬스터의 위협 즉시 파악
- **정보 스캔**: 색상으로 중요 정보 빠르게 필터링

## 이전 버전과의 차이

**이전 버전 (v11-16-09:52)**:
- HP 정보가 하단에 함께 표시
- 모든 로그가 동일한 색상
- 플레이어와 몬스터 HP 구분 없음

**현재 버전**:
- 플레이어 HP는 상단에 굵게 강조
- 몬스터 HP는 하단에 옅은 붉은색
- 몬스터 공격 로그는 붉은색으로 표시

## 다음 AI를 위한 참고사항

1. **색상 선택 이유**:
   - #fca5a5 (rose-300): Tailwind CSS의 rose-300, 충분히 밝아서 가독성 좋음
   - #e2e8f0 (slate-200): 밝은 흰색, 플레이어 정보 강조

2. **조건부 색상 확장**:
   - 현재는 간단한 문자열 포함 검사
   - 필요시 정규표현식이나 더 정교한 로직으로 변경 가능

3. **로그 형식 의존성**:
   - 로그 메시지 형식이 변경되면 조건 로직도 수정 필요
   - "몬스터 -> 플레이어" 형식 유지 필요

4. **반응형 고려**:
   - fontSize가 고정값 (16px, 14px)
   - 작은 화면에서는 조정 필요할 수 있음

5. **접근성**:
   - 색상만으로 정보 전달하지 않도록 주의
   - 아이콘이나 텍스트로 추가 구분 가능

## 변경 파일 목록

- `src/components/battle/LegacyBattleApp.jsx`
  - ExpectedDamagePreview 컴포넌트 재구성 (401-456줄)
  - HP 정보 레이아웃 변경 (플레이어 상단, 몬스터 하단)
  - 로그 색상 조건부 적용
- `src/components/map/MapDemo.jsx`
  - 버전 태그 업데이트
- `CHANGELOG/v11-16-09-59.md`
  - 새 버전 문서 생성
